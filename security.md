# EnergyTycoon 프로젝트 보안 분석 보고서

## 1. 최종 보안 등급: C+

### 등급 산정 근거
백엔드는 비교적 준수한 보안 관행을 따르고 있으나, 기본 JWT 시크릿 키 사용과 같은 치명적인 설정 오류가 존재합니다. 프론트엔드는 민감한 사용자 정보를 `localStorage`에 저장하는 등 몇 가지 중요한 보안 취약점을 가지고 있습니다. 이 두 가지 요소를 종합하여 **C+** 등급으로 평가했습니다.

---

## 2. 분야별 상세 분석 및 등급

### A. 백엔드 (보안 등급: B-)

백엔드는 전반적으로 좋은 시도가 많았지만, 일부 중요한 허점이 발견되었습니다.

#### 주요 분석 내용
*   **인증 및 권한 부여 (Strengths):**
    *   `passlib`를 사용한 강력한 비밀번호 해싱(bcrypt, pbkdf2_sha256) 적용.
    *   Access/Refresh 토큰 기반의 표준적인 인증 방식 사용.
    *   Refresh 토큰 폐기(Revocation) 로직 구현.
*   **API 엔드포인트 보안 (Strengths):**
    *   로그인 시도에 대한 IP 및 계정 기반의 Rate-Limiting(제한)을 구현하여 Brute-force 공격 방어.
    *   CORS(Cross-Origin Resource Sharing)를 특정 도메인에 대해서만 허용하도록 설정.
*   **보안 취약점 (Weaknesses):**
    *   **(위험도: 높음)** `JWT_SECRET` 환경변수 미설정 시, 하드코딩된 기본 시크릿 키를 사용하도록 되어 있어 프로덕션 배포 시 매우 위험합니다.
    *   **(위험도: 중간)** Rate-Limiting 로직이 서버 메모리 내에서만 동작하여, 서버 인스턴스가 여러 개일 경우 우회가 가능합니다.
    *   **(위험도: 낮음)** 로그인 시 존재하지 않는 사용자에 대해 "User not found" 에러를 반환하여, 사용자 계정 존재 여부를 추측할 수 있는 'Username Enumeration' 취약점이 있습니다.
    *   **(위험도: 낮음)** `requirements.txt`에 라이브러리 버전이 명시되지 않아, 향후 예기치 않은 보안 취약점이 발생할 수 있습니다.

### B. 프론트엔드 (보안 등급: C)

프론트엔드는 사용자 경험을 위한 기능 구현은 잘 되어 있으나, 데이터 저장 및 처리에 있어 보안 고려가 부족합니다.

#### 주요 분석 내용
*   **API 연동 (Strengths):**
    *   `axios` 인터셉터를 사용하여 API 요청/응답을 중앙에서 관리.
    *   Access Token 만료 시 자동으로 재발급을 시도하는 로직 구현.
    *   CSRF 토큰을 쿠키에서 읽어와 요청 헤더에 자동으로 추가하는 로직 구현.
*   **보안 취약점 (Weaknesses):**
    *   **(위험도: 높음)** 민감할 수 있는 사용자 정보를 `localStorage`에 저장합니다. `localStorage`는 XSS 공격에 취약하여, 공격자가 스크립트를 통해 저장된 사용자 정보를 탈취할 수 있습니다.
    *   **(위험도: 낮음)** 직접 구현한 "Trap" 쿠키 기반의 변조 방지 로직이 과도하게 복잡하고, 표준적이지 않아 우회될 가능성이 있습니다. 이는 오히려 유지보수를 어렵게 만들 수 있습니다.

---

## 3. 취약점 요약 및 권고 사항

| 구분 | 발견된 취약점 | 위험도 | 권고 사항 |
| :--- | :--- | :--- | :--- |
| **백엔드** | 하드코딩된 기본 JWT 시크릿 키 사용 | **높음** | 기본 JWT 시크릿을 제거하고, 환경변수가 없을 경우 앱이 시작되지 않도록 수정 |
| **백엔드** | 메모리 기반 Rate-Limiting | **중간** | `Redis`와 같은 중앙화된 저장소를 사용하여 여러 서버 인스턴스 간 상태를 공유 |
| **백엔드** | Username Enumeration (사용자 존재 여부 추측) | **낮음** | 잘못된 아이디 또는 비밀번호 입력 시, 동일한 에러 메시지("로그인 정보가 올바르지 않습니다.")를 반환 |
| **백엔드** | 고정되지 않은 라이브러리 버전 | **낮음** | `pip-tools` 등을 사용하여 `requirements.txt` 파일 내 모든 라이브러리 버전을 고정 |
| **프론트엔드**| 민감 정보 `localStorage` 저장 | **높음** | `localStorage`에는 사용자 닉네임, 테마 등 민감하지 않은 정보만 저장하고, 게임 데이터 등은 필요시마다 서버에서 조회 |
| **프론트엔드**| 복잡한 커스텀 보안 로직 ("Trap" 쿠키) | **낮음** | 해당 로직을 제거하고, `HttpOnly`, `Secure`, `SameSite` 속성이 적용된 쿠키와 CSP(Content Security Policy) 등 표준적인 보안 정책에 의존 |

---

## 4. (참고) 일반적인 웹 애플리케이션 종류별 보안 등급

웹 애플리케이션의 목적과 다루는 데이터의 민감도에 따라 요구되는 보안 수준이 다릅니다.

| 종류 | 일반적인 보안 등급 | 주요 특징 |
| :--- | :--- | :--- |
| **개인 블로그 / 회사 소개 사이트** | **B+** | 대부분 정적 콘텐츠. 회원가입/로그인 기능이 있다면 최소한의 보안 요구 |
| **커뮤니티 / 소셜 미디어** | **A** | 대량의 개인정보를 다루므로 강력한 계정 보안, XSS/CSRF 방어 필수 |
| **온라인 쇼핑몰 (E-commerce)** | **A+** | 결제 정보, 주소 등 매우 민감한 정보를 다루므로 PCI-DSS 등 규제 준수 필요 |
| **온라인 뱅킹 / 핀테크** | **A++** | 최고 수준의 보안 요구. 다중 인증(MFA), 암호화, 엄격한 규제 준수 필수 |
| **기업용 내부 관리 도구** | **B** | 내부망에서 사용되더라도 계정 관리, 권한 분리 등 기본적인 보안 체계 필요 |
